<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://github.com/accenture/mercury/guides/CHAPTER-1/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Chapter-1 - Mercury</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Chapter-1";
        var mkdocs_page_input_path = "guides\\CHAPTER-1.md";
        var mkdocs_page_url = "/accenture/mercury/guides/CHAPTER-1/";
      </script>
    
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> Mercury
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../TABLE-OF-CONTENTS/">Contents</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="./">Chapter-1</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#composable-application-architecture">Composable application architecture</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#main-module">Main module</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#business-logic-modules">Business logic modules</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#event-orchestration">Event orchestration</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#the-composable-engine">The Composable engine</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#rest-automation">REST automation</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#in-memory-event-system">In-memory event system</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#local-pubsub-system">Local pub/sub system</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#other-user-facing-channels">Other user facing channels</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#test-drive-a-sample-application">Test drive a sample application</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../CHAPTER-2/">Chapter-2</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../CHAPTER-3/">Chapter-3</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../CHAPTER-4/">Chapter-4</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../CHAPTER-5/">Chapter-5</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../CHAPTER-6/">Chapter-6</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../CHAPTER-7/">Chapter-7</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../APPENDIX-I/">Appendix-I</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../APPENDIX-II/">Appendix-II</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG/">Release notes</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../arch-decisions/DESIGN-NOTES/">Design notes</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../INCLUSIVITY/">Inclusivity</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../CODE_OF_CONDUCT/">Code of Conduct</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../CONTRIBUTING/">Contribution</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Mercury</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" alt="Docs"></a> &raquo;</li>
      <li>Chapter-1</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="introduction">Introduction</h1>
<p>Mercury version 3 is a toolkit for writing composable applications.</p>
<p>At the platform level, composable architecture refers to loosely coupled platform services, utilities, and
business applications. With modular design, you can assemble platform components and applications to create
new use cases or to adjust for ever-changing business environment and requirements. Domain driven design (DDD),
Command Query Responsibility Segregation (CQRS) and Microservices patterns are the popular tools that architects
use to build composable architecture. You may deploy application in container, serverless or other means.</p>
<p>At the application level, a composable application means that an application is assembled from modular software
components or functions that are self-contained and pluggable. You can mix-n-match functions to form new applications.
You can retire outdated functions without adverse side effect to a production system. Multiple versions of a function
can exist, and you can decide how to route user requests to different versions of a function. Applications would be
easier to design, develop, maintain, deploy, and scale.</p>
<h2 id="composable-application-architecture">Composable application architecture</h2>
<blockquote>
<p>Figure 1 - Composable application architecture</p>
</blockquote>
<p><img alt="architecture.png" src="../diagrams/architecture.png" /></p>
<p>As shown in Figure 1, a minimalist composable application consists of three user defined components:</p>
<ol>
<li>Main modules that provides an entry point to your application</li>
<li>One or more business logic modules (shown as "function-1" to "function-3" in the diagram)</li>
<li>An event orchestration module to command the business logic modules to work together as an application</li>
</ol>
<p>and a composable event engine that provides:</p>
<ol>
<li>REST automation</li>
<li>An in-memory event system (aka "event loop")</li>
<li>Local pub/sub system</li>
</ol>
<h3 id="main-module">Main module</h3>
<p>Each application has an entry point. You may implement an entry point in a main application like this:</p>
<pre><code class="language-javascript">async function main() {
    // ...
    // Load composable functions into memory
    ComposableLoader.initialize();
    // your main application code here
    // ...
}

main();
</code></pre>
<p>For a command line use case, your main application ("MainApp") module would get command line arguments and
send the request as an event to a business logic function for processing.</p>
<p>For a backend application, the MainApp is usually used to do some "initialization" or setup steps for your
services.</p>
<p>The "ComposableLoader.initialize()" statement will load your user functions into the event loop. There is
no need to directly import each module in your application. The "ComposableLoader" automates the loading.</p>
<p>Please configure the functions to be loaded in <code>src/resources/preload.yaml</code>.</p>
<h3 id="business-logic-modules">Business logic modules</h3>
<p>Your user function module may look like this:</p>
<pre><code class="language-typescript">export class HelloWorldService implements Composable {

    name = &quot;hello.world&quot;;

    @preload()
    initialize(): void {
        // no-op
    }

    getName(): string {
        return this.name;
    }

    async handleEvent(evt: EventEnvelope) {
        // your business logic here
        return someResult;
    }
}
</code></pre>
<p>Each function in a composable application should be implemented in the first principle of "input-process-output".
It should be stateless and self-contained. i.e. it has no direct dependencies with any other functions in the
composable application. Each function is addressable by a unique "route name". Input and output can be
primitive value or JSON objects to be transported using standard event envelopes.</p>
<p>In the above example, the unique "route name" of the function is "hello.world".</p>
<blockquote>
<p>Writing code in the first principle of "input-process-output" promotes Test Driven Development (TDD) because
  interface contact is clearly defined. Self-containment means code is more readable too.</p>
</blockquote>
<h3 id="event-orchestration">Event orchestration</h3>
<p>A transaction can pass through one or more user functions. In this case, you can write a user function to receive
request from a user, make requests to some user functions, and consolidate the responses before responding to the
user.</p>
<p>Note that event orchestration is optional. In the most basic REST application, the REST automation system can send
the user request to a function directly. When the function finishes processing, its output will be routed as
a HTTP response to the user.</p>
<h3 id="the-composable-engine">The Composable engine</h3>
<p>Event routing is done behind the curtain by the composable engine which consists of the REST automation service,
an in-memory event system ("event loop") and an optional localized pub/sub system.</p>
<h3 id="rest-automation">REST automation</h3>
<p>REST automation creates REST endpoints by configuration rather than code. You can define a REST endpoint like this:</p>
<pre><code class="language-yaml">  - service: &quot;hello.world&quot;
    methods: ['GET']
    url: &quot;/api/hello/world&quot;
    timeout: 10s
</code></pre>
<p>In this example, when a HTTP request is received at the URL path "/api/hello/world", the REST automation system
will convert the HTTP request into an event for onward delivery to the user defined function "hello.world". 
Your function will receive the HTTP request as input and return a result set that will be sent as a HTTP response
to the user.</p>
<p>For more sophisticated business logic, you can write a function to receive the HTTP request and do
"event orchestration". i.e. you can do data transformation and send "events" to other user functions to
process the request.</p>
<h3 id="in-memory-event-system">In-memory event system</h3>
<p>The composable engine encapsulates the standard Node.js EventEmitter library for event routing. It exposes the
"PostOffice" API for your orchestration function to send async or RPC events.</p>
<h3 id="local-pubsub-system">Local pub/sub system</h3>
<p>The in-memory event system is designed for point-to-point delivery. In some use cases, you may like to have
a broadcast channel so that more than one function can receive the same event. For example, sending notification
events to multiple functions. The optional local pub/sub system provides this multicast capability.</p>
<h3 id="other-user-facing-channels">Other user facing channels</h3>
<p>While REST is the most popular user facing interface, there are other communication means such as event triggers
in a serverless environment. You can write a function to listen to these external event triggers and send the events
to your user defined functions. This custom "adapter" pattern is illustrated as the dotted line path in Figure 1.</p>
<h2 id="test-drive-a-sample-application">Test drive a sample application</h2>
<p>To visualize what is a Composable application, let's try out the "Hello World" application in Chapter 2.</p>
<p><br/></p>
<table>
<thead>
<tr>
<th align="center">Home</th>
<th align="center">Chapter-2</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><a href="../TABLE-OF-CONTENTS/">Table of Contents</a></td>
<td align="center"><a href="../CHAPTER-2/">Hello World application</a></td>
</tr>
</tbody>
</table>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../TABLE-OF-CONTENTS/" class="btn btn-neutral float-left" title="Contents"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../CHAPTER-2/" class="btn btn-neutral float-right" title="Chapter-2">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../TABLE-OF-CONTENTS/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../CHAPTER-2/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
